<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>B</title>
    <meta name="description" content="Using D3v4 to create a Bubble chart. Based on NYT visualization">
    <meta name="author" content="Jim Vallandingham">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
    .bar--positive {

        fill: steelblue;
    }

    .bar--negative {

        fill: brown;
    }

    </style>
    <script src="lib/d3.js"></script>

    <script src="lib/jquery.min.js"></script>
</head>

<body>
    <script>
    $(function() {
        var margin = { top: 20, right: 30, bottom: 40, left: 30 },
            width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

        var x = d3.scaleLinear()
            .domain([0, 12])
            .range([0, width]);


        var svg = d3.select("body").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)

        var gradient = svg.append("defs")
            .append("linearGradient")
            .attr("id", "gradient")
            // 这里能控制方向
            .attr("x1", "0%")
            .attr("y1", "0%")
            .attr("x2", "100%")
            .attr("y2", "100%")
            .attr("spreadMethod", "pad");

        gradient.append("stop")
            .attr("offset", "0%")
            .attr("stop-color", '#FF9782')
            .attr("stop-opacity", 1);

        gradient.append("stop")
            .attr("offset", "100%")
            .attr("stop-color", '#F9D34C')
            .attr("stop-opacity", 1);

        var filter = svg.append("defs")
            .append("filter")
            .attr("id", "blur");

        filter
            .append("feGaussianBlur")
            .attr("result", "blurOut")
            .attr("in", "offOut")
            .attr("stdDeviation", 10);

        filter.append("feOffset")
            .attr("in", "blur")
            .attr("dx", 0)
            .attr("dy", 0)
            .attr("result", "offset")

        var g2 = svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        g2.append("text")
            .attr("x", width/2)
            .attr("y", height/2)
            .attr("dx", "-80")
            .attr("dy", "0")
            .attr("fill", "url(#gradient)")
            .attr("font-size", "80")
            .text(35)

        g2.append("text")
            .attr("x", width/2)
            .attr("y", height/2)
            .attr("dx", "0")
            .attr("dy", "-70")
            .attr("fill", "#000")
            .attr("font-size", "20")
            .text("%")

        g2.append("text")
            .attr("x", width/2)
            .attr("y", height/2)
            .attr("dx", "-60")
            .attr("dy", "30")
            .attr("fill", "#000")
            .attr("font-size", "30")
            .text("CTR")

        var g1 = svg.append("g")
            .attr("transform", "translate(" + width/2 + "," + height/2 + ")");

        var bgpath = d3.arc()
            .outerRadius(130)
            .innerRadius(100)
            .startAngle(Math.PI*1/3)
            .endAngle(Math.PI*2);

        var path = d3.arc()
            .outerRadius(140)
            .innerRadius(90)
            .startAngle(0)
            .endAngle(Math.PI*1/3);

        var pathShadow = d3.arc()
            .outerRadius(140)
            .innerRadius(90)
            .startAngle(0)
            .endAngle(Math.PI*1/3)


        g1.append("path")
            .attr("class", "bg")
            .attr("d", bgpath)
            .attr("fill", "#000")

        g1.append("path")
            .attr("class", "fb")
            .attr("d", path)
            .attr("fill", "url(#gradient)")


        g1.append("path")
            .attr("class", "fbs")
            .attr("d", pathShadow)
            .attr("opacity", 0.6)
            .attr("fill", "url(#gradient)")
            .attr("filter", "url(#blur)");



    })
    </script>
</body>

</html>